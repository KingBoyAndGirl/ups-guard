# å¸¸è§é—®é¢˜ä¸æ•…éšœæ’æŸ¥ FAQ

æœ¬æ–‡æ¡£å›ç­”ç”¨æˆ·æœ€å¸¸è§çš„é—®é¢˜ï¼Œå¹¶æä¾›è¯¦ç»†çš„æ•…éšœæ’æŸ¥æŒ‡å—ã€‚

---

## ğŸ“‹ ç›®å½•

1. [å®æ—¶æ€§æµ‹è¯•](#å®æ—¶æ€§æµ‹è¯•)
2. [äº‹ä»¶é©±åŠ¨æœªæ¿€æ´»](#äº‹ä»¶é©±åŠ¨æœªæ¿€æ´»)
3. [é€šä¿¡æ¬¡æ•°éªŒè¯](#é€šä¿¡æ¬¡æ•°éªŒè¯)
4. [é©±åŠ¨è°ƒè¯•çº§åˆ«](#é©±åŠ¨è°ƒè¯•çº§åˆ«)
5. [æ€§èƒ½ä¼˜åŒ–å»ºè®®](#æ€§èƒ½ä¼˜åŒ–å»ºè®®)

---

## ğŸš€ å®æ—¶æ€§æµ‹è¯•

### Q1: æˆ‘æ€ä¹ˆæŸ¥çœ‹å’Œè®°å½•å“åº”æ—¶é—´ï¼Ÿ

æœ‰å¤šç§æ–¹æ³•å¯ä»¥æµ‹è¯•å’Œè®°å½•ç³»ç»Ÿçš„å“åº”æ—¶é—´ï¼š

#### æ–¹æ³• 1ï¼šæµè§ˆå™¨å¼€å‘è€…å·¥å…·æµ‹è¯•ï¼ˆæœ€ç®€å•ï¼‰â­

**æ­¥éª¤**ï¼š

1. æ‰“å¼€ Dashboard é¡µé¢
2. æŒ‰ `F12` æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
3. åˆ‡æ¢åˆ° **Consoleï¼ˆæ§åˆ¶å°ï¼‰** æ ‡ç­¾é¡µ
4. ç²˜è´´ä»¥ä¸‹æµ‹è¯•ä»£ç ï¼š

```javascript
// å“åº”æ—¶é—´æµ‹è¯•è„šæœ¬
(async function testResponseTime() {
    console.log('='.repeat(50));
    console.log('ğŸ“Š UPS Guard - å“åº”æ—¶é—´æµ‹è¯•');
    console.log('='.repeat(50));
    
    // å‡†å¤‡æµ‹è¯•
    console.log('\n1ï¸âƒ£ è¯·åœ¨ 5 ç§’å†…æ‹”æ‰ UPS ç”µæº...');
    await new Promise(resolve => setTimeout(resolve, 5000));
    
    // å¼€å§‹è®¡æ—¶
    console.log('2ï¸âƒ£ å¼€å§‹è®°å½•å“åº”æ—¶é—´...\n');
    const startTime = Date.now();
    let detected = false;
    
    // ç›‘å¬ WebSocket æ¶ˆæ¯
    const ws = new WebSocket(`ws://${window.location.host}/ws?token=${localStorage.getItem('api_token')}`);
    
    ws.onopen = () => {
        console.log('âœ… WebSocket è¿æ¥å·²å»ºç«‹');
    };
    
    ws.onmessage = (event) => {
        const data = JSON.parse(event.data);
        if (!detected && data.type === 'status_update') {
            const status = data.data.status;
            const currentStatus = status?.toLowerCase();
            
            if (currentStatus === 'onbattery' || currentStatus === 'on_battery') {
                detected = true;
                const responseTime = Date.now() - startTime;
                
                console.log('\n' + '='.repeat(50));
                console.log('âœ… æ£€æµ‹åˆ°çŠ¶æ€å˜åŒ–ï¼');
                console.log('='.repeat(50));
                console.log(`â±ï¸  å“åº”æ—¶é—´: ${responseTime} æ¯«ç§’ (${(responseTime/1000).toFixed(2)} ç§’)`);
                console.log(`ğŸ“Š çŠ¶æ€: ${status}`);
                console.log(`âš¡ ç”µæ± ç”µé‡: ${data.data.battery_charge}%`);
                console.log(`ğŸ”‹ é¢„è®¡ç»­èˆª: ${Math.floor(data.data.battery_runtime/60)} åˆ†é’Ÿ`);
                console.log('='.repeat(50));
                
                // æ€§èƒ½è¯„ä¼°
                if (responseTime < 500) {
                    console.log('ğŸ† æ€§èƒ½è¯„çº§: ä¼˜ç§€ï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰');
                } else if (responseTime < 2000) {
                    console.log('ğŸ‘ æ€§èƒ½è¯„çº§: è‰¯å¥½');
                } else if (responseTime < 5000) {
                    console.log('âš ï¸  æ€§èƒ½è¯„çº§: ä¸€èˆ¬ï¼ˆè½®è¯¢æ¨¡å¼ï¼‰');
                } else {
                    console.log('âŒ æ€§èƒ½è¯„çº§: éœ€è¦ä¼˜åŒ–');
                }
                
                ws.close();
            }
        }
    };
    
    ws.onerror = (error) => {
        console.error('âŒ WebSocket é”™è¯¯:', error);
    };
    
    // 30ç§’è¶…æ—¶
    setTimeout(() => {
        if (!detected) {
            console.log('â° æµ‹è¯•è¶…æ—¶ï¼ˆ30ç§’ï¼‰- æœªæ£€æµ‹åˆ°çŠ¶æ€å˜åŒ–');
            console.log('ğŸ’¡ æç¤º: è¯·ç¡®ä¿å·²ç»æ‹”æ‰ UPS ç”µæº');
            ws.close();
        }
    }, 30000);
})();
```

5. æŒ‰ **Enter** è¿è¡Œ
6. æŒ‰ç…§æç¤ºæ‹”æ‰ UPS ç”µæº
7. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºçš„å“åº”æ—¶é—´

**è¾“å‡ºç¤ºä¾‹**ï¼š

```
==================================================
âœ… æ£€æµ‹åˆ°çŠ¶æ€å˜åŒ–ï¼
==================================================
â±ï¸  å“åº”æ—¶é—´: 85 æ¯«ç§’ (0.09 ç§’)
ğŸ“Š çŠ¶æ€: ONBATTERY
âš¡ ç”µæ± ç”µé‡: 100%
ğŸ”‹ é¢„è®¡ç»­èˆª: 22 åˆ†é’Ÿ
==================================================
ğŸ† æ€§èƒ½è¯„çº§: ä¼˜ç§€ï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰
```

#### æ–¹æ³• 2ï¼šä½¿ç”¨æµè§ˆå™¨ Network æ ‡ç­¾ï¼ˆæ‰‹åŠ¨æµ‹è¯•ï¼‰

1. æ‰“å¼€ Dashboard
2. æŒ‰ `F12` â†’ **Network** æ ‡ç­¾é¡µ
3. ç­›é€‰ **WS**ï¼ˆWebSocketï¼‰
4. æŸ¥çœ‹ `ws` è¿æ¥
5. ç‚¹å‡»ååœ¨å³ä¾§æŸ¥çœ‹ **Messages**
6. **è®°å½•å½“å‰æ—¶é—´**ï¼ˆä¾‹å¦‚ 14:30:00ï¼‰
7. æ‹”æ‰ UPS ç”µæº
8. è§‚å¯Ÿ Messages ä¸­å‡ºç° `status_update` çš„æ—¶é—´
9. è®¡ç®—æ—¶é—´å·®

**è§£è¯»**ï¼š
- < 500msï¼šäº‹ä»¶é©±åŠ¨æ¨¡å¼ï¼Œä¼˜ç§€ ğŸ†
- 500ms - 2sï¼šæ··åˆæ¨¡å¼æˆ–å¿«é€Ÿè½®è¯¢ï¼Œè‰¯å¥½ ğŸ‘
- 2s - 5sï¼šè½®è¯¢æ¨¡å¼ï¼Œæ­£å¸¸ âš ï¸
- \> 5sï¼šéœ€è¦æ£€æŸ¥é…ç½®æˆ–ç½‘ç»œ âŒ

#### æ–¹æ³• 3ï¼šä½¿ç”¨åç«¯æ—¥å¿—ï¼ˆæœ€å‡†ç¡®ï¼‰

**æ­¥éª¤**ï¼š

1. æ‰“å¼€ç»ˆç«¯
2. æŸ¥çœ‹åç«¯å®æ—¶æ—¥å¿—ï¼š

```bash
docker logs -f ups-guard-backend
```

3. è®°å½•å½“å‰æ—¶é—´
4. æ‹”æ‰ UPS ç”µæº
5. è§‚å¯Ÿæ—¥å¿—ä¸­çš„æ—¶é—´æˆ³

**æŸ¥æ‰¾å…³é”®æ—¥å¿—**ï¼š

```
2026-02-15 01:20:30 - services.monitor - INFO - Status changed: ONLINE -> ONBATTERY
```

**è®¡ç®—å“åº”æ—¶é—´**ï¼š`æ—¥å¿—æ—¶é—´ - æ‹”ç”µæºæ—¶é—´`

---

## ğŸ”Œ äº‹ä»¶é©±åŠ¨æœªæ¿€æ´»

### Q2: æˆ‘é€‰æ‹©æ··åˆæ¨¡å¼ï¼Œä¸ºä»€ä¹ˆäº‹ä»¶é©±åŠ¨çŠ¶æ€æ˜¾ç¤º"æœªæ¿€æ´»"ï¼Ÿ

äº‹ä»¶é©±åŠ¨æœªæ¿€æ´»æœ‰ 4 ä¸ªå¸¸è§åŸå› ï¼š

### åŸå›  1ï¼šNUT ç‰ˆæœ¬è¿‡æ—§ âš ï¸

**ç—‡çŠ¶**ï¼š
- ç›‘æ§ç»Ÿè®¡æ˜¾ç¤ºï¼š"hybrid (polling)"
- äº‹ä»¶é©±åŠ¨çŠ¶æ€ï¼šâŒ æœªæ¿€æ´»

**æ£€æŸ¥æ–¹æ³•**ï¼š

```bash
# æ£€æŸ¥ NUT ç‰ˆæœ¬
docker exec -it nut-server upsd -V

# æˆ–
docker exec -it nut-server nut-scanner -V
```

**è¦æ±‚**ï¼š
- âœ… NUT 2.7.4 åŠä»¥ä¸Š â†’ æ”¯æŒ LISTEN å‘½ä»¤
- âŒ NUT 2.7.3 åŠä»¥ä¸‹ â†’ ä¸æ”¯æŒäº‹ä»¶é©±åŠ¨

**è§£å†³æ–¹æ¡ˆ**ï¼š

å¦‚æœç‰ˆæœ¬è¿‡æ—§ï¼Œéœ€è¦å‡çº§ NUTï¼š

```bash
# åœæ­¢å®¹å™¨
docker-compose down

# æ‹‰å–æœ€æ–°é•œåƒ
docker-compose pull

# é‡æ–°å¯åŠ¨
docker-compose up -d

# éªŒè¯ç‰ˆæœ¬
docker exec -it nut-server upsd -V
```

### åŸå›  2ï¼šUPS å›ºä»¶ä¸æ”¯æŒ ğŸ“±

**ç—‡çŠ¶**ï¼š
- NUT ç‰ˆæœ¬æ­£ç¡®ï¼ˆâ‰¥ 2.7.4ï¼‰
- ä½†äº‹ä»¶é©±åŠ¨ä»æœªæ¿€æ´»
- åç«¯æ—¥å¿—æ˜¾ç¤º `LISTEN not supported`

**æ£€æŸ¥æ–¹æ³•**ï¼š

```bash
# æŸ¥çœ‹åç«¯æ—¥å¿—
docker logs ups-guard-backend 2>&1 | grep -i "listen"

# å¯èƒ½çš„è¾“å‡ºï¼š
# "NUT LISTEN not supported: ERR UNKNOWN-COMMAND"
```

**è¯´æ˜**ï¼š

éƒ¨åˆ† UPS å‹å·æˆ–å›ºä»¶ä¸æ”¯æŒ NUT çš„ LISTEN æœºåˆ¶ï¼Œç‰¹åˆ«æ˜¯ï¼š
- è€å‹å· UPS
- å…¥é—¨çº§ UPS
- éæ ‡å‡† USB HID åè®®çš„ UPS

**è§£å†³æ–¹æ¡ˆ**ï¼š

âœ… **ä½¿ç”¨æ··åˆæ¨¡å¼**ï¼ˆå·²ç»æ˜¯æœ€ä½³é€‰æ‹©ï¼‰ï¼š
- ç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§åˆ°è½®è¯¢æ¨¡å¼
- ä»ç„¶æä¾›å¯é çš„ç›‘æ§
- é€šä¿¡é¢‘ç‡å·²ä¼˜åŒ–åˆ° 60 ç§’ï¼ˆæ¯”é»˜è®¤ 5 ç§’å¥½å¾ˆå¤šï¼‰

### åŸå›  3ï¼šç½‘ç»œè¿æ¥é—®é¢˜ ğŸŒ

**ç—‡çŠ¶**ï¼š
- äº‹ä»¶é©±åŠ¨æ—¶å¥½æ—¶å
- é¢‘ç¹åœ¨"æ´»è·ƒ"å’Œ"æœªæ¿€æ´»"é—´åˆ‡æ¢

**æ£€æŸ¥æ–¹æ³•**ï¼š

```bash
# 1. æµ‹è¯• NUT æœåŠ¡å™¨è¿æ¥
docker exec -it ups-guard-backend ping nut-server -c 4

# 2. æµ‹è¯• NUT ç«¯å£
docker exec -it ups-guard-backend nc -zv nut-server 3493

# 3. æŸ¥çœ‹ NUT æœåŠ¡å™¨çŠ¶æ€
docker logs nut-server --tail 50
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ Docker ç½‘ç»œé…ç½®
- ç¡®ä¿å®¹å™¨é—´å¯ä»¥æ­£å¸¸é€šä¿¡
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### åŸå›  4ï¼šé…ç½®æœªæ­£ç¡®ç”Ÿæ•ˆ âš™ï¸

**ç—‡çŠ¶**ï¼š
- ä¿®æ”¹äº†ç›‘æ§æ¨¡å¼
- ä½†äº‹ä»¶é©±åŠ¨çŠ¶æ€æ²¡æœ‰å˜åŒ–

**æ£€æŸ¥æ­¥éª¤**ï¼š

1. **éªŒè¯é…ç½®å·²ä¿å­˜**ï¼š
   ```bash
   # æŸ¥çœ‹é…ç½®æ–‡ä»¶
   docker exec -it ups-guard-backend cat /data/ups_guard.db | strings | grep monitoring_mode
   ```

2. **é‡å¯åç«¯æœåŠ¡**ï¼š
   ```bash
   docker restart ups-guard-backend
   ```

3. **ç­‰å¾… 30 ç§’**è®©äº‹ä»¶é©±åŠ¨åˆå§‹åŒ–

4. **åˆ·æ–° Settings é¡µé¢**æŸ¥çœ‹ç›‘æ§ç»Ÿè®¡

### éªŒè¯äº‹ä»¶é©±åŠ¨æ˜¯å¦å·¥ä½œ

**æœ€ç»ˆéªŒè¯æ–¹æ³•**ï¼š

1. ç¡®è®¤"äº‹ä»¶é©±åŠ¨çŠ¶æ€"ä¸º âœ… æ´»è·ƒ
2. æ‹”æ‰ UPS ç”µæº
3. è§‚å¯Ÿå“åº”æ—¶é—´ï¼š
   - **< 500ms** â†’ äº‹ä»¶é©±åŠ¨æ­£å¸¸å·¥ä½œ âœ…
   - **2-5 ç§’** â†’ ä½¿ç”¨è½®è¯¢æ¨¡å¼ âš ï¸

---

## ğŸ“Š é€šä¿¡æ¬¡æ•°éªŒè¯

### Q3: æ··åˆæ¨¡å¼ä¸‹å¼€æœºä¸åˆ°åŠå°æ—¶ï¼Œä»Šæ—¥é€šä¿¡æ¬¡æ•°306ï¼Œå¯¹å—ï¼Ÿ

**ç­”æ¡ˆï¼šæ­£å¸¸ï¼** è®©æˆ‘è¯¦ç»†è§£é‡Šï¼š

### é€šä¿¡æ¬¡æ•°è®¡ç®—

æ··åˆæ¨¡å¼ä¸‹çš„é€šä¿¡æ¥æºï¼š

#### 1. å¯åŠ¨åˆå§‹åŒ–ï¼ˆçº¦ 20-50 æ¬¡ï¼‰

**å¯åŠ¨é˜¶æ®µé€šä¿¡**ï¼š
- è¿æ¥å»ºç«‹ï¼š5-10 æ¬¡
- è¯»å–åˆå§‹çŠ¶æ€ï¼š10-20 æ¬¡
- å‚æ•°éªŒè¯ï¼š5-10 æ¬¡
- äº‹ä»¶é©±åŠ¨å°è¯•ï¼š3-5 æ¬¡
- å¿ƒè·³å»ºç«‹ï¼š2-3 æ¬¡

**å°è®¡ï¼šçº¦ 25-48 æ¬¡**

#### 2. è½®è¯¢å¤‡ä»½ï¼ˆæ¯å°æ—¶ 60 æ¬¡ï¼‰

**æ··åˆæ¨¡å¼è½®è¯¢é¢‘ç‡**ï¼š
- äº‹ä»¶é©±åŠ¨æ´»è·ƒï¼š60 ç§’/æ¬¡
- æ¯å°æ—¶ï¼š60 æ¬¡
- åŠå°æ—¶ï¼š30 æ¬¡

å¦‚æœäº‹ä»¶é©±åŠ¨æœªæ¿€æ´»ï¼ˆé™çº§ä¸ºçº¯è½®è¯¢ï¼‰ï¼š
- 60 ç§’/æ¬¡ï¼ˆé™çº§åçš„è½®è¯¢é—´éš”ï¼‰
- åŠå°æ—¶ï¼š30 æ¬¡

#### 3. äº‹ä»¶è§¦å‘é€šä¿¡ï¼ˆå˜åŒ–æ—¶ï¼‰

**å¸¸è§è§¦å‘äº‹ä»¶**ï¼š
- ç”µé‡å˜åŒ–ï¼šæ¯ 1-2% è§¦å‘ä¸€æ¬¡ï¼ˆçº¦ 2-5 æ¬¡/å°æ—¶ï¼‰
- ç”µå‹æ³¢åŠ¨ï¼šç”µç½‘ä¸ç¨³å®šæ—¶å¯èƒ½è§¦å‘å¤šæ¬¡
- è´Ÿè½½å˜åŒ–ï¼šæ’æ‹”è®¾å¤‡æ—¶è§¦å‘
- æ¸©åº¦å˜åŒ–ï¼šç¯å¢ƒæ¸©åº¦å˜åŒ–æ—¶è§¦å‘

**ä¼°ç®—**ï¼š10-50 æ¬¡/å°æ—¶

#### 4. ç”¨æˆ·æ“ä½œï¼ˆæ‰‹åŠ¨åˆ·æ–°ã€ä¿®æ”¹å‚æ•°ï¼‰

**æ¯æ¬¡æ“ä½œ**ï¼š1-3 æ¬¡é€šä¿¡
- åˆ·æ–°é¡µé¢ï¼š1 æ¬¡
- ä¿®æ”¹å‚æ•°ï¼š1-2 æ¬¡
- æŸ¥çœ‹è®¾ç½®ï¼š1 æ¬¡

**ä¼°ç®—**ï¼š5-20 æ¬¡ï¼ˆå–å†³äºæ“ä½œé¢‘ç‡ï¼‰

### ä½ çš„æƒ…å†µåˆ†æ

**ä½ çš„æ•°æ®**ï¼š
- æ—¶é•¿ï¼š< 30 åˆ†é’Ÿ
- é€šä¿¡æ¬¡æ•°ï¼š306 æ¬¡

**åˆ†è§£è®¡ç®—**ï¼š

```
å¯åŠ¨åˆå§‹åŒ–ï¼š    ~40 æ¬¡
è½®è¯¢å¤‡ä»½ï¼ˆ30åˆ†é’Ÿï¼‰ï¼š  30 æ¬¡
äº‹ä»¶è§¦å‘ï¼š      ~200 æ¬¡  â† è¿™é‡Œè¾ƒå¤š
ç”¨æˆ·æ“ä½œï¼š      ~36 æ¬¡
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡ï¼š         ~306 æ¬¡ âœ…
```

### ä¸ºä»€ä¹ˆäº‹ä»¶è§¦å‘è¿™ä¹ˆå¤šï¼Ÿ

**å¯èƒ½çš„åŸå› **ï¼š

1. **ç”µç½‘è´¨é‡ä¸ç¨³å®š**ï¼š
   - ç”µå‹é¢‘ç¹æ³¢åŠ¨
   - æ¯æ¬¡æ³¢åŠ¨è§¦å‘ä¸€æ¬¡ DATACHANGED äº‹ä»¶
   - **è¿™æ˜¯æœ€å¸¸è§çš„åŸå› ** âš ï¸

2. **UPS è´Ÿè½½å˜åŒ–**ï¼š
   - ç”µè„‘é£æ‰‡è½¬é€Ÿå˜åŒ–
   - ç¡¬ç›˜è¯»å†™å¯¼è‡´åŠŸç‡æ³¢åŠ¨
   - æ˜¾ç¤ºå™¨äº®åº¦è°ƒæ•´

3. **UPS çŠ¶æ€æ›´æ–°é¢‘ç¹**ï¼š
   - æŸäº› UPS ä¼šé¢‘ç¹æ›´æ–°å†…éƒ¨çŠ¶æ€
   - ä¾‹å¦‚ï¼šç”µæ± ç”µé‡ä»¥ 0.1% ç²¾åº¦æ›´æ–°

4. **äº‹ä»¶é©±åŠ¨æ¨¡å¼ä¼˜åŠ¿**ï¼š
   - ä¼ ç»Ÿè½®è¯¢æ¨¡å¼ä¸‹ï¼Œè¿™äº›å˜åŒ–å¯èƒ½è¢«å»¶è¿Ÿæ£€æµ‹
   - äº‹ä»¶é©±åŠ¨æ¨¡å¼å®æ—¶æ•è·æ‰€æœ‰å˜åŒ–
   - **è¿™ä¸æ˜¯é—®é¢˜ï¼Œè€Œæ˜¯åŠŸèƒ½ï¼** âœ…

### æ˜¯å¦éœ€è¦æ‹…å¿ƒï¼Ÿ

**ç­”æ¡ˆï¼šä¸éœ€è¦æ‹…å¿ƒï¼**

**åŸå› **ï¼š

1. **é€šä¿¡å¼€é”€æå°**ï¼š
   - æ¯æ¬¡é€šä¿¡ï¼š< 1KB æ•°æ®
   - 306 æ¬¡ Ã— 1KB = 0.3MBï¼ˆåŠå°æ—¶ï¼‰
   - **å¯¹ç½‘ç»œå’Œæ€§èƒ½å½±å“å¯å¿½ç•¥ä¸è®¡**

2. **æ¯”è½®è¯¢æ¨¡å¼æ›´å¥½**ï¼š
   - ä¼ ç»Ÿ 5 ç§’è½®è¯¢ï¼š30 åˆ†é’Ÿ = 360 æ¬¡
   - ä½ çš„æ··åˆæ¨¡å¼ï¼š30 åˆ†é’Ÿ = 306 æ¬¡
   - **ä»ç„¶æ›´å°‘ï¼** âœ…

3. **å®æ—¶æ€§æ›´å¥½**ï¼š
   - æ‰€æœ‰çŠ¶æ€å˜åŒ–ç«‹å³æ£€æµ‹
   - ä¸ä¼šé”™è¿‡ä»»ä½•é‡è¦äº‹ä»¶
   - æ›´å®‰å…¨ã€æ›´å¯é 

### å¦‚ä½•éªŒè¯æ˜¯å¦æ­£å¸¸ï¼Ÿ

**å¥åº·æŒ‡æ ‡**ï¼š

| æŒ‡æ ‡ | å¥åº·èŒƒå›´ | ä½ çš„æ•°æ® | è¯„ä¼° |
|------|---------|---------|------|
| **æ¯å°æ—¶é€šä¿¡æ¬¡æ•°** | 100-1000 | ~600 | âœ… æ­£å¸¸ |
| **å¯åŠ¨å 1 å°æ—¶** | 200-800 | 306ï¼ˆåŠå°æ—¶ï¼‰ | âœ… å¥åº· |
| **å“åº”å»¶è¿Ÿ** | < 500ms | ï¼ˆéœ€æµ‹è¯•ï¼‰ | - |
| **CPU å ç”¨** | < 5% | ï¼ˆéœ€æŸ¥çœ‹ï¼‰ | - |

**æŸ¥çœ‹ CPU å ç”¨**ï¼š

```bash
docker stats ups-guard-backend
```

å¦‚æœ CPU < 5%ï¼Œåˆ™å®Œå…¨æ­£å¸¸ âœ…

### é•¿æœŸè§‚å¯Ÿå»ºè®®

**å»ºè®®è®°å½• 24 å°æ—¶æ•°æ®**ï¼š

1. æ—©ä¸Šè®°å½•é€šä¿¡æ¬¡æ•°ï¼šä¾‹å¦‚ 500
2. æ™šä¸Šè®°å½•é€šä¿¡æ¬¡æ•°ï¼šä¾‹å¦‚ 2800
3. è®¡ç®—å¢é‡ï¼š2800 - 500 = 2300 æ¬¡/å¤©

**é¢„æœŸèŒƒå›´**ï¼š
- **äº‹ä»¶é©±åŠ¨æ´»è·ƒ**ï¼š1500-3000 æ¬¡/å¤©ï¼ˆæ­£å¸¸ï¼‰
- **çº¯è½®è¯¢æ¨¡å¼**ï¼š1440 æ¬¡/å¤©ï¼ˆ60ç§’è½®è¯¢ï¼‰
- **ä¼ ç»Ÿè½®è¯¢**ï¼š17280 æ¬¡/å¤©ï¼ˆ5ç§’è½®è¯¢ï¼‰

---

## ğŸ”§ é©±åŠ¨è°ƒè¯•çº§åˆ«

### Q4: é©±åŠ¨è°ƒè¯•çº§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ

**é©±åŠ¨è°ƒè¯•çº§åˆ«**ï¼ˆDriver Debug Levelï¼‰æ˜¯ NUT é©±åŠ¨ç¨‹åºçš„æ—¥å¿—è¯¦ç»†ç¨‹åº¦æ§åˆ¶å‚æ•°ã€‚

### ä»€ä¹ˆæ˜¯é©±åŠ¨è°ƒè¯•çº§åˆ«ï¼Ÿ

**å®šä¹‰**ï¼š

NUT é©±åŠ¨ç¨‹åºå¯ä»¥è¾“å‡ºä¸åŒè¯¦ç»†ç¨‹åº¦çš„æ—¥å¿—ä¿¡æ¯ï¼Œé€šè¿‡è°ƒè¯•çº§åˆ«æ§åˆ¶ï¼š

| çº§åˆ« | åç§° | è¾“å‡ºå†…å®¹ | ç”¨é€” |
|------|------|---------|------|
| **0** | æ— è°ƒè¯• | ä»…é”™è¯¯ä¿¡æ¯ | ç”Ÿäº§ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰ |
| **1** | åŸºæœ¬ | + è­¦å‘Šä¿¡æ¯ | æ—¥å¸¸ç›‘æ§ |
| **2** | è¯¦ç»† | + çŠ¶æ€å˜åŒ– | é—®é¢˜æ’æŸ¥ |
| **3** | éå¸¸è¯¦ç»† | + USB é€šä¿¡ | æ·±åº¦è°ƒè¯• |
| **4** | å®Œå…¨è°ƒè¯• | + æ‰€æœ‰æ•°æ®åŒ… | å¼€å‘è°ƒè¯• |

### ä¸ºä»€ä¹ˆéœ€è¦è°ƒè¯•çº§åˆ«ï¼Ÿ

**å¸¸è§ä½¿ç”¨åœºæ™¯**ï¼š

1. **æ’æŸ¥ UPS è¿æ¥é—®é¢˜**ï¼š
   - UPS æ— æ³•è¯†åˆ«
   - é©±åŠ¨å¯åŠ¨å¤±è´¥
   - USB é€šä¿¡é”™è¯¯

2. **åˆ†æå‚æ•°é—®é¢˜**ï¼š
   - æŸä¸ªå‚æ•°è¯»å–å¤±è´¥
   - å‚æ•°å€¼å¼‚å¸¸
   - LISTEN å‘½ä»¤ä¸å·¥ä½œ

3. **å¼€å‘å’Œæµ‹è¯•**ï¼š
   - ç†è§£ UPS åè®®
   - æµ‹è¯•æ–°åŠŸèƒ½
   - æ€§èƒ½åˆ†æ

### å½“å‰ç³»ç»Ÿçš„é©±åŠ¨è°ƒè¯•çº§åˆ«

**æŸ¥çœ‹å½“å‰å€¼**ï¼š

```bash
# æ–¹æ³• 1ï¼šé€šè¿‡ NUT å‘½ä»¤
docker exec -it nut-server upsc ups driver.debug

# è¾“å‡ºï¼š0ï¼ˆé»˜è®¤ï¼‰
```

**æŸ¥çœ‹å®æ—¶æ—¥å¿—**ï¼š

```bash
docker logs -f nut-server
```

### å¦‚ä½•ä¿®æ”¹é©±åŠ¨è°ƒè¯•çº§åˆ«ï¼Ÿ

#### æ–¹æ³• 1ï¼šç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰

**ç¼–è¾‘ `docker-compose.yml`**ï¼š

```yaml
services:
  nut-server:
    environment:
      - LOG_LEVEL=debug  # æ·»åŠ è¿™ä¸€è¡Œ
```

**é‡å¯å®¹å™¨**ï¼š

```bash
docker-compose down
docker-compose up -d
```

#### æ–¹æ³• 2ï¼šä¿®æ”¹ ups.confï¼ˆé«˜çº§ï¼‰

**è¿›å…¥å®¹å™¨**ï¼š

```bash
docker exec -it nut-server sh
```

**ç¼–è¾‘é…ç½®**ï¼š

```bash
vi /etc/nut/ups.conf
```

**æ·»åŠ è°ƒè¯•é€‰é¡¹**ï¼š

```ini
[ups]
    driver = usbhid-ups
    port = auto
    debug_level = 3  # æ·»åŠ è¿™ä¸€è¡Œ
```

**é‡å¯é©±åŠ¨**ï¼š

```bash
upsdrvctl stop
upsdrvctl start
```

### è°ƒè¯•è¾“å‡ºç¤ºä¾‹

**çº§åˆ« 0ï¼ˆé»˜è®¤ï¼‰**ï¼š

```
2026-02-15 01:00:00 Network UPS Tools - Generic HID driver 0.41 (2.7.4)
2026-02-15 01:00:00 USB communication driver 0.33
```

**çº§åˆ« 2ï¼ˆè¯¦ç»†ï¼‰**ï¼š

```
2026-02-15 01:00:00 Network UPS Tools - Generic HID driver 0.41 (2.7.4)
2026-02-15 01:00:00 USB communication driver 0.33
2026-02-15 01:00:05 Device: 051d:0002 - APC Back-UPS BK650M2-CH
2026-02-15 01:00:05 HID descriptor length 603
2026-02-15 01:00:05 Report descriptor retrieved
2026-02-15 01:00:06 Path: UPS.PowerSummary.Voltage, Type: Feature
2026-02-15 01:00:06 Value: 230.0
```

**çº§åˆ« 3ï¼ˆéå¸¸è¯¦ç»†ï¼‰**ï¼š

```
2026-02-15 01:00:00 Network UPS Tools - Generic HID driver 0.41 (2.7.4)
2026-02-15 01:00:00 USB communication driver 0.33
2026-02-15 01:00:05 Device: 051d:0002 - APC Back-UPS BK650M2-CH
2026-02-15 01:00:05 Entering libusb_get_report
2026-02-15 01:00:05 Report[buf]: 01 02 03 04 05 ...
2026-02-15 01:00:05 Entering libusb_set_report
2026-02-15 01:00:06 send_to_all: SETINFO ups.status "OL"
```

### ä½•æ—¶éœ€è¦å¯ç”¨è°ƒè¯•ï¼Ÿ

#### åœºæ™¯ 1ï¼šUPS æ— æ³•è¯†åˆ«

**ç—‡çŠ¶**ï¼š
- `upsc ups` è¿”å›é”™è¯¯
- Dashboard æ˜¾ç¤º"ç¦»çº¿"

**å¯ç”¨è°ƒè¯•**ï¼š

```bash
# è®¾ç½®çº§åˆ« 3
docker exec -it nut-server upsdrvctl stop
docker exec -it nut-server sh -c "echo 'debug_level = 3' >> /etc/nut/ups.conf"
docker exec -it nut-server upsdrvctl start

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker logs -f nut-server
```

**æŸ¥æ‰¾**ï¼š
- USB è®¾å¤‡è¯†åˆ«ä¿¡æ¯
- é©±åŠ¨åŠ è½½é”™è¯¯
- HID æè¿°ç¬¦é—®é¢˜

#### åœºæ™¯ 2ï¼šäº‹ä»¶é©±åŠ¨ä¸å·¥ä½œ

**ç—‡çŠ¶**ï¼š
- æ··åˆæ¨¡å¼ä¸‹äº‹ä»¶é©±åŠ¨æœªæ¿€æ´»
- æ€€ç–‘ LISTEN å‘½ä»¤é—®é¢˜

**å¯ç”¨è°ƒè¯•**ï¼š

```bash
# è®¾ç½®åç«¯æ—¥å¿—çº§åˆ«ä¸º DEBUG
docker-compose down
# ç¼–è¾‘ docker-compose.ymlï¼Œæ·»åŠ ï¼š
# backend:
#   environment:
#     - LOG_LEVEL=DEBUG

docker-compose up -d

# æŸ¥çœ‹åç«¯æ—¥å¿—
docker logs -f ups-guard-backend | grep -i listen
```

**æŸ¥æ‰¾**ï¼š
- LISTEN å‘½ä»¤å‘é€
- DATACHANGED é€šçŸ¥æ¥æ”¶
- å¿ƒè·³æ¶ˆæ¯

#### åœºæ™¯ 3ï¼šå‚æ•°å¼‚å¸¸

**ç—‡çŠ¶**ï¼š
- æŸä¸ªå‚æ•°å€¼ä¸æ­£ç¡®
- å‚æ•°æ— æ³•ä¿®æ”¹

**å¯ç”¨è°ƒè¯•**ï¼š

```bash
# çº§åˆ« 2 è¶³å¤Ÿ
docker exec -it nut-server sh
echo 'debug_level = 2' >> /etc/nut/ups.conf
upsdrvctl restart
```

**æŸ¥çœ‹**ï¼š
- å‚æ•°è¯»å–æ—¥å¿—
- SET VAR å‘½ä»¤æ‰§è¡Œ
- é”™è¯¯ä¿¡æ¯

### è°ƒè¯•å®Œæˆåè®°å¾—å…³é—­ï¼

**é‡è¦æé†’** âš ï¸ï¼š

è°ƒè¯•çº§åˆ« 3-4 ä¼šäº§ç”Ÿ**å¤§é‡æ—¥å¿—**ï¼š
- æ¯ç§’å¯èƒ½äº§ç”Ÿæ•°ç™¾è¡Œæ—¥å¿—
- ç£ç›˜ç©ºé—´å¿«é€Ÿæ¶ˆè€—
- å½±å“æ€§èƒ½

**å®Œæˆè°ƒè¯•ååŠ¡å¿…å…³é—­**ï¼š

```bash
# ç§»é™¤è°ƒè¯•é…ç½®
docker exec -it nut-server sh
sed -i '/debug_level/d' /etc/nut/ups.conf
upsdrvctl restart

# æˆ–é‡ç½®ç¯å¢ƒå˜é‡
docker-compose down
# ç§»é™¤ LOG_LEVEL=debug
docker-compose up -d
```

### æŸ¥çœ‹ç³»ç»Ÿå½“å‰é…ç½®

```bash
# æŸ¥çœ‹é©±åŠ¨é…ç½®
docker exec -it nut-server cat /etc/nut/ups.conf

# æŸ¥çœ‹å½“å‰è°ƒè¯•çº§åˆ«
docker exec -it nut-server upsc ups driver.debug

# æŸ¥çœ‹åç«¯æ—¥å¿—çº§åˆ«
docker exec -it ups-guard-backend printenv LOG_LEVEL
```

---

## ğŸ’¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### æ··åˆæ¨¡å¼æœ€ä½³å®è·µ

**æ¨èé…ç½®**ï¼š

```yaml
ç›‘æ§æ¨¡å¼: æ··åˆæ¨¡å¼
å¯ç”¨äº‹ä»¶é©±åŠ¨: âœ…
å¿ƒè·³é—´éš”: 30 ç§’
è‡ªåŠ¨é™çº§: âœ…
é™çº§è½®è¯¢é—´éš”: 60 ç§’
```

### é€šä¿¡æ¬¡æ•°ä¼˜åŒ–å»ºè®®

**å¦‚æœä½ æƒ³è¿›ä¸€æ­¥å‡å°‘é€šä¿¡æ¬¡æ•°**ï¼š

1. **å¢åŠ å¿ƒè·³é—´éš”**ï¼ˆè°¨æ…ï¼‰ï¼š
   - å½“å‰ï¼š30 ç§’
   - å¯æ”¹ä¸ºï¼š45-60 ç§’
   - é£é™©ï¼šè¿æ¥æ–­å¼€æ£€æµ‹å»¶è¿Ÿ

2. **å¢åŠ é™çº§è½®è¯¢é—´éš”**ï¼š
   - å½“å‰ï¼š60 ç§’
   - å¯æ”¹ä¸ºï¼š120 ç§’
   - é£é™©ï¼šäº‹ä»¶é©±åŠ¨å¤±è´¥æ—¶å“åº”æ…¢

3. **ä½†ä¸å»ºè®®**ï¼š
   - å½“å‰é…ç½®å·²ç»å¾ˆä¼˜åŒ–
   - é€šä¿¡å¼€é”€å¯å¿½ç•¥ä¸è®¡
   - å®æ—¶æ€§æ›´é‡è¦

### ç›‘æ§å¥åº·æ£€æŸ¥æ¸…å•

å®šæœŸæ£€æŸ¥ä»¥ä¸‹æŒ‡æ ‡ï¼š

- [ ] äº‹ä»¶é©±åŠ¨çŠ¶æ€ï¼šâœ… æ´»è·ƒï¼ˆå¦‚æœæ”¯æŒï¼‰
- [ ] æ¯å°æ—¶é€šä¿¡æ¬¡æ•°ï¼š100-1000 æ¬¡
- [ ] å“åº”å»¶è¿Ÿï¼š< 500ms
- [ ] CPU å ç”¨ï¼š< 5%
- [ ] å†…å­˜å ç”¨ï¼š< 200MB
- [ ] WebSocket è¿æ¥ï¼šæ­£å¸¸
- [ ] æœ€åæ›´æ–°æ—¶é—´ï¼š< 60 ç§’å‰

---

## ğŸ” æ•…éšœæ’æŸ¥é€ŸæŸ¥è¡¨

| ç—‡çŠ¶ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|---------|---------|
| äº‹ä»¶é©±åŠ¨æœªæ¿€æ´» | NUT ç‰ˆæœ¬ < 2.7.4 | å‡çº§ NUT |
| äº‹ä»¶é©±åŠ¨æœªæ¿€æ´» | UPS ä¸æ”¯æŒ LISTEN | æ¥å—é™çº§ï¼Œä»æœ‰ä¼˜åŒ– |
| é€šä¿¡æ¬¡æ•°å¼‚å¸¸å¤š | ç”µç½‘ä¸ç¨³å®š | æ­£å¸¸ç°è±¡ï¼Œå®æ—¶ç›‘æ§ä¼˜åŠ¿ |
| å“åº”å»¶è¿Ÿ > 5s | è½®è¯¢æ¨¡å¼ä¸”é—´éš”é•¿ | æ£€æŸ¥ç›‘æ§æ¨¡å¼é…ç½® |
| CPU å ç”¨é«˜ | è°ƒè¯•çº§åˆ«è¿‡é«˜ | å…³é—­è°ƒè¯•æ¨¡å¼ |
| WebSocket æ–­å¼€ | ç½‘ç»œé—®é¢˜ | æ£€æŸ¥ç½‘ç»œè¿æ¥ |

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æµ‹è¯•éªŒè¯æŒ‡å—](./testing-and-verification-guide.md) - è¯¦ç»†çš„æµ‹è¯•æ­¥éª¤
- [ç”¨æˆ·æŒ‡å— - ç›‘æ§æ¨¡å¼](./user-guide.md#ç›‘æ§æ¨¡å¼è®¾ç½®) - é…ç½®è¯´æ˜
- [å®æ–½æ€»ç»“](../IMPLEMENTATION_SUMMARY.md) - æŠ€æœ¯ç»†èŠ‚

---

**éœ€è¦æ›´å¤šå¸®åŠ©ï¼Ÿ** æŸ¥çœ‹åç«¯æ—¥å¿—æˆ–æäº¤ GitHub Issueï¼
